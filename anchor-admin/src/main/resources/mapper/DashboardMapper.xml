<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gov.web.mapper.DashboardMapper">

    <!-- 获取AE设备数量 -->
    <select id="getAeDeviceCount" resultType="Integer">
        SELECT COUNT(*) FROM ae_dev_list
    </select>
    
    <!-- 获取RA设备数量 -->
    <select id="getRaDeviceCount" resultType="Integer">
        SELECT COUNT(*) FROM ra_dev_list
    </select>
    
    <!-- 获取今日AE数据总量 -->
    <select id="getTodayAeDataCount" resultType="Long" parameterType="String">
        SELECT
        (SELECT COUNT(*) FROM ae_tdsk_raem1_001_data WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_002_data WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_003_data WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_004_data WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_005_data WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_006_data WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_007_data WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_008_data WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_009_data WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_010_data WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_011_data WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_012_data WHERE DATE(create_time) = #{today}) AS total_count
    </select>
    
    <!-- 获取今日RA数据总量 -->
    <select id="getTodayRaDataCount" resultType="Long" parameterType="String">
        SELECT
        (SELECT COUNT(*) FROM `ra_01-1-1_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-1-2_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-1-3_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-1-4_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-1-5_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-1-6_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-1-7_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-1-8_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-1-9_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-2-1_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-2-2_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-2-3_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-2-4_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-2-5_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-2-6_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-2-7_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-2-8_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-2-9_a_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-5-1_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-5-2_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-5-3_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-5-4_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-5-5_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-5-6_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-5-7_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-5-8_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-5-9_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-6-1_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-6-2_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-6-3_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-6-4_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-6-5_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-6-6_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-6-7_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-6-8_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-6-9_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-7-1_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-7-2_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-7-3_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-7-4_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-7-5_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-7-6_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-7-7_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-7-8_c_data` WHERE DATE(create_time) = #{today}) +
        (SELECT COUNT(*) FROM `ra_01-7-9_c_data` WHERE DATE(create_time) = #{today}) AS total_count
    </select>
    
    <!-- 获取历史AE数据总量 -->
    <select id="getTotalAeDataCount" resultType="Long">
        SELECT
        (SELECT COUNT(*) FROM ae_tdsk_raem1_001_data) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_002_data) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_003_data) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_004_data) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_005_data) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_006_data) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_007_data) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_008_data) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_009_data) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_010_data) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_011_data) +
        (SELECT COUNT(*) FROM ae_tdsk_raem1_012_data) AS total_count
    </select>
    
    <!-- 获取历史RA数据总量 -->
    <select id="getTotalRaDataCount" resultType="Long">
        SELECT
        (SELECT COUNT(*) FROM `ra_01-1-1_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-1-2_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-1-3_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-1-4_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-1-5_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-1-6_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-1-7_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-1-8_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-1-9_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-2-1_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-2-2_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-2-3_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-2-4_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-2-5_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-2-6_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-2-7_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-2-8_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-2-9_a_data`) +
        (SELECT COUNT(*) FROM `ra_01-5-1_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-5-2_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-5-3_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-5-4_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-5-5_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-5-6_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-5-7_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-5-8_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-5-9_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-6-1_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-6-2_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-6-3_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-6-4_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-6-5_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-6-6_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-6-7_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-6-8_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-6-9_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-7-1_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-7-2_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-7-3_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-7-4_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-7-5_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-7-6_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-7-7_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-7-8_c_data`) +
        (SELECT COUNT(*) FROM `ra_01-7-9_c_data`) AS total_count
    </select>

    <!-- AeData结果映射 -->
    <resultMap id="AeDataResultMap" type="com.gov.web.domain.AeData">
        <id property="id" column="id"/>
        <result property="deviceId" column="device_id"/>
        <result property="amp" column="amp"/>
        <result property="asl" column="asl"/>
        <result property="energy" column="energy"/>
        <result property="rms" column="rms"/>
        <result property="riseTime" column="rise_Time"/>
        <result property="riseCount" column="rise_Count"/>
        <result property="ringCount" column="ring_Count"/>
        <result property="duration" column="duration"/>
        <result property="timestamp" column="timestamp"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

    <!-- 获取AE实时数据 -->
    <select id="getAeLatestData" resultMap="AeDataResultMap">
        SELECT '001' AS device_id, id, amp, asl, energy, rms, rise_Time, rise_Count, ring_Count, duration, timestamp, create_time 
        FROM ae_tdsk_raem1_001_data 
        WHERE create_time = (SELECT MAX(create_time) FROM ae_tdsk_raem1_001_data)
        UNION ALL
        SELECT '002' AS device_id, id, amp, asl, energy, rms, rise_Time, rise_Count, ring_Count, duration, timestamp, create_time 
        FROM ae_tdsk_raem1_002_data 
        WHERE create_time = (SELECT MAX(create_time) FROM ae_tdsk_raem1_002_data)
        UNION ALL
        SELECT '003' AS device_id, id, amp, asl, energy, rms, rise_Time, rise_Count, ring_Count, duration, timestamp, create_time 
        FROM ae_tdsk_raem1_003_data 
        WHERE create_time = (SELECT MAX(create_time) FROM ae_tdsk_raem1_003_data)
        UNION ALL
        SELECT '004' AS device_id, id, amp, asl, energy, rms, rise_Time, rise_Count, ring_Count, duration, timestamp, create_time 
        FROM ae_tdsk_raem1_004_data 
        WHERE create_time = (SELECT MAX(create_time) FROM ae_tdsk_raem1_004_data)
        UNION ALL
        SELECT '005' AS device_id, id, amp, asl, energy, rms, rise_Time, rise_Count, ring_Count, duration, timestamp, create_time 
        FROM ae_tdsk_raem1_005_data 
        WHERE create_time = (SELECT MAX(create_time) FROM ae_tdsk_raem1_005_data)
        UNION ALL
        SELECT '006' AS device_id, id, amp, asl, energy, rms, rise_Time, rise_Count, ring_Count, duration, timestamp, create_time 
        FROM ae_tdsk_raem1_006_data 
        WHERE create_time = (SELECT MAX(create_time) FROM ae_tdsk_raem1_006_data)
        UNION ALL
        SELECT '007' AS device_id, id, amp, asl, energy, rms, rise_Time, rise_Count, ring_Count, duration, timestamp, create_time 
        FROM ae_tdsk_raem1_007_data 
        WHERE create_time = (SELECT MAX(create_time) FROM ae_tdsk_raem1_007_data)
        UNION ALL
        SELECT '008' AS device_id, id, amp, asl, energy, rms, rise_Time, rise_Count, ring_Count, duration, timestamp, create_time 
        FROM ae_tdsk_raem1_008_data 
        WHERE create_time = (SELECT MAX(create_time) FROM ae_tdsk_raem1_008_data)
        UNION ALL
        SELECT '009' AS device_id, id, amp, asl, energy, rms, rise_Time, rise_Count, ring_Count, duration, timestamp, create_time 
        FROM ae_tdsk_raem1_009_data 
        WHERE create_time = (SELECT MAX(create_time) FROM ae_tdsk_raem1_009_data)
        UNION ALL
        SELECT '010' AS device_id, id, amp, asl, energy, rms, rise_Time, rise_Count, ring_Count, duration, timestamp, create_time 
        FROM ae_tdsk_raem1_010_data 
        WHERE create_time = (SELECT MAX(create_time) FROM ae_tdsk_raem1_010_data)
        UNION ALL
        SELECT '011' AS device_id, id, amp, asl, energy, rms, rise_Time, rise_Count, ring_Count, duration, timestamp, create_time 
        FROM ae_tdsk_raem1_011_data 
        WHERE create_time = (SELECT MAX(create_time) FROM ae_tdsk_raem1_011_data)
        UNION ALL
        SELECT '012' AS device_id, id, amp, asl, energy, rms, rise_Time, rise_Count, ring_Count, duration, timestamp, create_time 
        FROM ae_tdsk_raem1_012_data 
        WHERE create_time = (SELECT MAX(create_time) FROM ae_tdsk_raem1_012_data)
        ORDER BY device_id
    </select>

</mapper>